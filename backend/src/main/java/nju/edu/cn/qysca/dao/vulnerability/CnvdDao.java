package nju.edu.cn.qysca.dao.vulnerability;

import nju.edu.cn.qysca.domain.vulnerability.dos.CnvdDO;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;

@Repository
public interface CnvdDao extends JpaRepository<CnvdDO,String> {
    /**
     * 根据cnvd id查找漏洞信息
     * @param cnvdId cnvd id
     * @return 漏洞信息
     */
    CnvdDO findOneByCnvdId(String cnvdId);

    /**
     * 根据cve id查找漏洞信息
     * @param cveId cve id
     * @return 漏洞信息
     */
    @Query(value = "select * from plt_vulnerability_cnvd where cve_id = :cveId limit 1",nativeQuery = true)
    CnvdDO findOneByCveId(String cveId);
}
