package nju.edu.cn.qysca.dao.vulnerability;

import nju.edu.cn.qysca.domain.vulnerability.dos.CveCpeDO;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface CveCpeDao extends JpaRepository<CveCpeDO,String> {

    /**
     * 根据uri相似查询对应的信息
     * @param uri cpe uri
     * @return 相似查询结果
     */
    @Query(value = "select * from plt_vulnerability_cve_cpe where uri % :uri order by similarity(uri, :uri) desc limit 10",nativeQuery = true)
    List<CveCpeDO> findByUriSimilarity(String uri);

}
