package nju.edu.cn.qysca.domain.vulnerability;

import com.vladmihalcea.hibernate.type.array.StringArrayType;
import com.vladmihalcea.hibernate.type.json.JsonBinaryType;
import io.swagger.annotations.ApiModelProperty;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.hibernate.annotations.GenericGenerator;
import org.hibernate.annotations.Type;
import org.hibernate.annotations.TypeDef;
import org.hibernate.annotations.TypeDefs;

import javax.persistence.*;
import java.util.ArrayList;
import java.util.List;

@Data
@Builder
@AllArgsConstructor
@NoArgsConstructor
@Entity
@Table(name= "plt_vulnerability_cve")
@TypeDefs({
        @TypeDef(name = "string-array", typeClass = StringArrayType.class),
        @TypeDef(name = "jsonb",typeClass = JsonBinaryType.class)
})
public class CveDO {
    @Id
    @Column(name="id",nullable = false)
    @GenericGenerator(name = "jpa-uuid", strategy = "uuid")
    @GeneratedValue(generator = "jpa-uuid")
    @ApiModelProperty(value = "uuid", example = "402851818e4af0ab018e4af0bbc80000")
    private String id;

    @Column(name="cve_id",nullable = false,unique = true)
    @ApiModelProperty(value = "cve id",example = "CVE-2023-0689")
    private String cveId;

    @Column(name="cve_assigner")
    @ApiModelProperty(value = "cve 委托人",example = "cve@mitre.org")
    private String cveAssigner;

    @Column(name="problem_type")
    @ApiModelProperty(value = "问题类型",example = "NVD-CWE-Other")
    @Type(type = "string-array")
    private String[] problemType={};

    @Column(name="ref")
    @ApiModelProperty(value = "参考")
    @Type(type = "jsonb")
    private List<CveReferenceDO> references=new ArrayList<>();

    @Column(name="descriptions")
    @ApiModelProperty(value = "描述",example = "Cisco ONS 15327 before 4.1(3), ONS 15454 before 4.6.")
    @Type(type = "string-array")
    private String[] descriptions={};

    @Column(name="cvss3")
    @ApiModelProperty(value = "cvss 3.x")
    @Type(type = "jsonb")
    private CVSS3DO cvss3=new CVSS3DO();

    @Column(name="cvss2")
    @ApiModelProperty(value = "cvss 2.x")
    @Type(type = "jsonb")
    private CVSS2DO cvss2=new CVSS2DO();

    @Column(name="published_date")
    @ApiModelProperty(value = "发布时间", example = "2004-02-17T05:00Z")
    private String publishedDate;

    @Column(name="last_modified_date")
    @ApiModelProperty(value = "最后修改时间", example = "2017-10-10T01:30Z")
    private String lastModifiedDate;

}
