package nju.edu.cn.qysca.dao.vulnerability;

import nju.edu.cn.qysca.domain.vulnerability.dos.CpeMatchDO;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface CpeMatchDao extends JpaRepository<CpeMatchDO,String> {
    /**
     * 查找names数组字段中包含对应cpe的记录
     * @param cpe cpe uri
     * @return 符合条件的记录列表
     */
    @Query(value = "select * from plt_vulnerability_cpe_match where array_position(names, :cpe)>0",nativeQuery = true)
    List<CpeMatchDO> findAllByNamesContainCpe(String cpe);
}
