package nju.edu.cn.qysca;

import nju.edu.cn.qysca.service.vulnerability.VulnerabilityDataServiceImpl;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
public class VulnerabilityDataTest {
    @Autowired
    VulnerabilityDataServiceImpl vulnerabilityDataService;

    @Test
    public void test_createCpeMatch(){
        //vulnerabilityDataService.createCpeMatch();
        String filepath="D:\\vulnerability\\cpe_match.json";
        vulnerabilityDataService.createCpeMatch(filepath);
    }

    @Test
    public void test_createCve(){
        //vulnerabilityDataService.createCve();
        for(int i=2002;i<=2024;i++){
            String filepath="D:/vulnerability/nvdcve/nvdcve-1.1-"+i+".json";
            System.out.println("START YEAR "+i);
            vulnerabilityDataService.createCve(filepath);
        }
    }
}
