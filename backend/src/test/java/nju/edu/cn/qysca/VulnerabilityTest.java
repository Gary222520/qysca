package nju.edu.cn.qysca;

import nju.edu.cn.qysca.domain.vulnerability.dos.CweDO;
import nju.edu.cn.qysca.domain.vulnerability.dtos.VulnerabilityBriefDTO;
import nju.edu.cn.qysca.domain.vulnerability.dtos.VulnerabilityDTO;
import nju.edu.cn.qysca.service.vulnerability.VulnerabilityService;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.domain.Page;

import java.util.List;

@SpringBootTest
public class VulnerabilityTest {
    @Autowired
    VulnerabilityService vulnerabilityService;

    @Test
    public void test_findVulnerabilities() {
        String name="github.com/gin-gonic/gin";
        String version="v1.4.0";
        String language="golang";
        List<String> ans=vulnerabilityService.findVulnerabilities(name,version,language);
        System.out.println("ok");
    }

    @Test
    public void test_crud(){
        String name="go application";
        String version="1.0.0";
        int page=1;
        int size=2;
        VulnerabilityDTO vulnerabilityDTO=vulnerabilityService.findVulnerabilityById("CVE-2022-25845");
        CweDO cweDO=vulnerabilityService.findCweById("CWE-129");
        Page<VulnerabilityBriefDTO> page1=vulnerabilityService.getVulnerabilityList(name,version,page,size);
        Page<VulnerabilityBriefDTO> page2=vulnerabilityService.searchVulnerability("",page,size);
        System.out.println("ok");
    }
}
