package nju.edu.cn.qysca;

import nju.edu.cn.qysca.dao.vulnerability.CweDao;
import nju.edu.cn.qysca.domain.vulnerability.CweDO;
import nju.edu.cn.qysca.service.vulnerability.VulnerabilityService;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import java.util.List;

@SpringBootTest
public class VulnerabilityTest {
    @Autowired
    VulnerabilityService vulnerabilityService;

    @Autowired
    CweDao cweDao;

    @Test
    public void test_findVulnerabilities() {
        String name="github.com/gin-gonic/gin";
        String version="v1.4.0";
        String language="golang";
        List<String> ans=vulnerabilityService.findVulnerabilities(name,version,language);
        System.out.println("ok");
    }

    @Test
    public void test_findCwe(){
        CweDO cweDO=cweDao.findOneByCweId("NVD-CWE-Other");
        System.out.println("ok");
    }
}
