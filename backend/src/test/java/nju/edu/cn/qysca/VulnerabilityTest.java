package nju.edu.cn.qysca;

import nju.edu.cn.qysca.dao.vulnerability.CweDao;
import nju.edu.cn.qysca.domain.vulnerability.dos.CveDO;
import nju.edu.cn.qysca.domain.vulnerability.dos.CweDO;
import nju.edu.cn.qysca.domain.vulnerability.dtos.CveBriefDTO;
import nju.edu.cn.qysca.service.vulnerability.VulnerabilityService;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.domain.Page;

import java.util.List;

@SpringBootTest
public class VulnerabilityTest {
    @Autowired
    VulnerabilityService vulnerabilityService;

    @Autowired
    CweDao cweDao;

    @Test
    public void test_findVulnerabilities() {
        String name="github.com/gin-gonic/gin";
        String version="v1.4.0";
        String language="golang";
        List<String> ans=vulnerabilityService.findVulnerabilities(name,version,language);
        System.out.println("ok");
    }

    @Test
    public void test_findCwe(){
        CweDO cweDO=cweDao.findOneByCweId("NVD-CWE-Other");
        System.out.println("ok");
    }

    @Test
    public void test_crud(){
        String name="go application";
        String version="1.0.0";
        int page=1;
        int size=2;
        CveDO cveDO=vulnerabilityService.findCveById("CVE-2021-3121");
        CweDO cweDO=vulnerabilityService.findCweById("CWE-129");
        Page<CveBriefDTO> cveBriefDTOPage=vulnerabilityService.getCveList(name,version,page,size);
        System.out.println("ok");
    }
}
